<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Administra√ß√£o de Vendas - IMAGIN3D</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <main class="container" aria-label="√Årea principal de administra√ß√£o de vendas">

    <header>
      <h2>Administra√ß√£o de Vendas - IMAGIN3D</h2>
    </header>

    <!-- Se√ß√£o do formul√°rio -->
    <section aria-label="Formul√°rio de Lan√ßamento de Vendas">
      <form id="formulario">
        <div class="form-group">
          <label for="dataLancamento">Data do Lan√ßamento</label>
          <input type="text" id="dataLancamento" readonly>
        </div>

        <div class="form-group">
          <label for="descricao">Descri√ß√£o do Produto</label>
          <input type="text" id="descricao" placeholder="Digite a descri√ß√£o">
        </div>

        <div class="form-group">
          <label for="estoque">Quantidade de Vendas</label>
          <input type="number" id="estoque" placeholder="Digite a quantidade">
        </div>

        <div class="form-group">
          <label for="custo">Pre√ßo de Custo (R$)</label>
          <input type="text" id="custo" placeholder="Ex: 100,00">
        </div>

        <div class="form-group">
          <label for="taxaFixa">Tarifa de Venda (R$)</label>
          <input type="text" id="taxaFixa" placeholder="Ex: 5,00">
        </div>

        <div class="form-group">
          <label for="frete">Frete (R$)</label>
          <input type="text" id="frete" placeholder="Ex: 10,00">
        </div>

        <div class="form-group">
          <label for="gestao">Custo de Gest√£o de Vendas (R$)</label>
          <input type="text" id="gestao" placeholder="Ex: 2,50">
        </div>

        <div class="form-group">
          <label for="venda">Pre√ßo de Venda (R$)</label>
          <input type="text" id="venda" placeholder="Ex: 150,00">
        </div>
            
        <button type="button" id="btnCalcular" class="voltar" aria-label="Calcular e salvar lan√ßamento">Calcular e Salvar</button>
        
        <div class="form-group" style="margin-top: 30px;">
          <label for="lucro">Lucro (R$)</label>
          <input type="text" id="lucro" readonly>
        </div>
      </form>
    </section>

    <!-- Se√ß√£o de lan√ßamentos -->
    <section aria-label="Tabela de Lan√ßamentos Salvos">
      <h3>Lan√ßamentos Salvos</h3>
      <table id="tabelaLancamentos">
        <thead>
          <tr>
            <th>Data</th>
            <th>Descri√ß√£o</th>
            <th>Quant.Vendas</th>
            <th>Custo</th>
            <th>Tarifa</th>
            <th>Frete</th>
            <th>Gest√£o</th>
            <th>Pre√ßo Venda</th>
            <th>Lucro</th>
            <th>A√ß√µes</th>
          </tr>
        </thead>
        <tbody id="corpoTabela"></tbody>
      </table>

      <div class="form-group mt-3" style="margin-top: 30px;">
        <label for="totalLucro"><strong>Total de Lucro Acumulado (R$)</strong></label>
        <input type="text" id="totalLucro" readonly value="0,00">
      </div>
    </section>

    <!-- Dentro do <footer> ou logo ap√≥s a se√ß√£o de lan√ßamentos -->
<footer style="margin-top: 20px; text-align: center;">
  <!-- Bot√£o de Lucros Mensais -->
<a href="lucros.html" style="text-decoration: none;">
  <button type="button" class="voltar" aria-label="Visualizar lucros mensais">
    Ver Lucros Mensais
  </button>
</a>

<!-- Bot√£o de Logout -->
<button type="button" id="btnLogout" class="voltar" aria-label="Sair do sistema e voltar √† p√°gina de login" style="margin-top: 10px;">
  Sair e Voltar ao Login
</button>
  </footer><!--
      
  </section>

    <!-- Se√ß√£o de rodap√© -->
    <footer aria-label="Rodap√© da p√°gina">
      <p>&copy; 2023 IMAGIN3D. Todos os direitos reservados.</p>
    </footer>
    

  </main>

  <script src="admin-vendas.js"></script>
</body>
</html>
<script>
  // Fun√ß√£o para formatar valores monet√°rios
  function formatarMoeda(valor) {
    return valor.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
  }

  // Fun√ß√£o para calcular o lucro
  function calcularLucro(custo, taxaFixa, frete, gest√£o, venda) {
    return (venda - custo - taxaFixa - frete - gest√£o).toFixed(2);
  }
  
  // Fun√ß√£o para calcular o total de lucro acumulado
  function calcularTotalLucro(lucros) {
    return lucros.reduce((total, lucro) => total + parseFloat(lucro), 0).toFixed(2);
  }
  
  // Fun√ß√£o para atualizar a tabela de lan√ßamentos
  function atualizarTabela(lancamentos) {
    const corpoTabela = document.getElementById('corpoTabela');
    corpoTabela.innerHTML = ''; // Limpa a tabela antes de adicionar novos lan√ßamentos

    lancamentos.forEach((lancamento, index) => {
      const linha = document.createElement('tr');
      linha.innerHTML = `
        <td>${lancamento.data}</td>
        <td>${lancamento.descricao}</td>
        <td>${lancamento.quantidade}</td>
        <td>${formatarMoeda(lancamento.custo)}</td>
        <td>${formatarMoeda(lancamento.taxaFixa)}</td>
        <td>${formatarMoeda(lancamento.frete)}</td>
        <td>${formatarMoeda(lancamento.gestao)}</td>
        <td>${formatarMoeda(lancamento.precoVenda)}</td>
        <td>${formatarMoeda(lancamento.lucro)}</td>
        <td>
        <button type="button" class="btnEditar" data-index="${index}">‚úèÔ∏è Editar</button>
        <button type="button" class="btnExcluir" data-index="${index}">üóëÔ∏è Excluir</button>
        </td>

      corpoTabela.appendChild(linha);
    });
  }
  
  // Fun√ß√£o para salvar o lan√ßamento no localStorage
  function salvarLancamento(lancamento) {
    const lancamentos = JSON.parse(localStorage.getItem('lancamentos')) || [];
    lancamentos.push(lancamento);
    localStorage.setItem('lancamentos', JSON.stringify(lancamentos));
  }  
  
  // Fun√ß√£o para carregar os lan√ßamentos do localStorage
  function carregarLancamentos() {
    return JSON.parse(localStorage.getItem('lancamentos')) || [];
  } 
  
  // Fun√ß√£o para excluir um lan√ßamento do localStorage
  function excluirLancamento(index) {
    const lancamentos = carregarLancamentos();
    lancamentos.splice(index, 1);
    localStorage.setItem('lancamentos', JSON.stringify(lancamentos));
  } 
  
  // Fun√ß√£o para formatar o valor monet√°rio
  function formatarValor(valor) {
    return parseFloat(valor.replace(',', '.')).toFixed(2);
  } 
  
  // Fun√ß√£o para validar os campos do formul√°rio  
  function validarCampos() {
    const descricao = document.getElementById('descricao').value.trim();
    const quantidade = document.getElementById('estoque').value.trim();
    const custo = document.getElementById('custo').value.trim();
    const taxaFixa = document.getElementById('taxaFixa').value.trim();
    const frete = document.getElementById('frete').value.trim();
    const gestao = document.getElementById('gestao').value.trim();
    const precoVenda = document.getElementById('venda').value.trim();

    if (!descricao || !quantidade || !custo || !taxaFixa || !frete || !gestao || !precoVenda) {
      alert('Por favor, preencha todos os campos.');
      return false;
    }
    return true;
  } 

  // Fun√ß√£o para calcular e salvar o lan√ßamento
  
  function calcularESalvarLancamento() {
    const descricao = document.getElementById('descricao').value.trim();
    const quantidade = parseInt(document.getElementById('estoque').value.trim(), 10);
    const custo = formatarValor(document.getElementById('custo').value.trim());
    const taxaFixa = formatarValor(document.getElementById('taxaFixa').value.trim());
    const frete = formatarValor(document.getElementById('frete').value.trim());
    const gestao = formatarValor(document.getElementById('gestao').value.trim());
    const precoVenda = formatarValor(document.getElementById('venda').value.trim());

    if (!validarCampos()) return;

    const dataLancamento = new Date().toLocaleDateString('pt-BR');
    const lucro = calcularLucro(custo, taxaFixa, frete, gestao, precoVenda);

    const lancamento = {
      data: dataLancamento,
      descricao,
      quantidade,
      custo: parseFloat(custo),
      taxaFixa: parseFloat(taxaFixa),
      frete: parseFloat(frete),
      gestao: parseFloat(gestao),
      precoVenda: parseFloat(precoVenda),
      lucro: parseFloat(lucro)
    };

    salvarLancamento(lancamento);
    atualizarTabela(carregarLancamentos());

    // Atualiza o total de lucro acumulado
    const lucros = carregarLancamentos().map(l => l.lucro);
    document.getElementById('totalLucro').value = formatarMoeda(calcularTotalLucro(lucros));
  }
